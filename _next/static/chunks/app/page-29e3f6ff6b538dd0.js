(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3422:(e,s,t)=>{"use strict";t.d(s,{default:()=>sf});var a=t(5155),r=t(2115),l=t(8217),n=t(3463),i=t(9795);function d(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,i.QP)((0,n.$)(s))}let c=l.bL,o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.B8,{ref:s,className:d("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...r})});o.displayName=l.B8.displayName;let m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.l9,{ref:s,className:d("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...r})});m.displayName=l.l9.displayName;let u=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.UC,{ref:s,className:d("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r})});u.displayName=l.UC.displayName;let p=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:d("rounded-xl border bg-card text-card-foreground shadow",t),...r})});p.displayName="Card";let x=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:d("flex flex-col space-y-1.5 p-6",t),...r})});x.displayName="CardHeader";let h=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:d("font-semibold leading-none tracking-tight",t),...r})});h.displayName="CardTitle";let f=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:d("text-sm text-muted-foreground",t),...r})});f.displayName="CardDescription";let j=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:d("p-6 pt-0",t),...r})});j.displayName="CardContent";let g=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:d("flex items-center p-6 pt-0",t),...r})});g.displayName="CardFooter";var v=t(2317),N=t(1027);let y=(0,N.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),b=r.forwardRef((e,s)=>{let{className:t,variant:r,size:l,asChild:n=!1,...i}=e,c=n?v.DX:"button";return(0,a.jsx)(c,{className:d(y({variant:r,size:l,className:t})),ref:s,...i})});b.displayName="Button";var w=t(2645),C=t(5325),S=t(437),D=t(8070),E=t(5524),I=t(4683);function R(e){let{department:s,isExpanded:t=!1,onToggleExpand:r,onEdit:l,onDelete:n,onAddSubdepartment:i,onManageEmployees:d}=e,c=s.level<3;return(0,a.jsxs)(p,{className:"w-full max-w-sm border-2 ".concat(1===s.level?"border-blue-300":2===s.level?"border-green-300":"border-yellow-300"),children:[(0,a.jsx)(x,{className:"pb-2",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(h,{className:"text-lg",children:s.name}),(0,a.jsx)(f,{children:(e=>{switch(e){case 1:return"Служба";case 2:return"Отдел";case 3:return"Группа";default:return"Подразделение"}})(s.level)})]}),s.childDepartments.length>0&&(0,a.jsx)(b,{variant:"ghost",size:"icon",onClick:r,children:t?(0,a.jsx)(w.A,{className:"h-4 w-4"}):(0,a.jsx)(C.A,{className:"h-4 w-4"})})]})}),(0,a.jsxs)(j,{className:"pb-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:s.description}),(0,a.jsxs)("div",{className:"flex items-center mt-2 text-sm text-muted-foreground",children:[(0,a.jsx)(S.A,{className:"h-4 w-4 mr-1"}),(0,a.jsxs)("span",{children:[s.employees.length," сотрудников"]})]}),s.childDepartments.length>0&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:[s.childDepartments.length," подразделений"]})]}),(0,a.jsxs)(g,{className:"flex justify-between pt-2",children:[(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(b,{variant:"outline",size:"icon",onClick:l,children:(0,a.jsx)(D.A,{className:"h-4 w-4"})}),(0,a.jsx)(b,{variant:"outline",size:"icon",onClick:n,children:(0,a.jsx)(E.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex gap-1",children:[c&&(0,a.jsx)(b,{variant:"outline",size:"icon",onClick:i,children:(0,a.jsx)(I.A,{className:"h-4 w-4"})}),(0,a.jsx)(b,{variant:"outline",size:"icon",onClick:d,children:(0,a.jsx)(S.A,{className:"h-4 w-4"})})]})]})]})}var k=t(6217),A=t(689);let T=k.bL;k.l9;let O=k.ZL;k.bm;let L=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(k.hJ,{ref:s,className:d("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});L.displayName=k.hJ.displayName;let z=r.forwardRef((e,s)=>{let{className:t,children:r,...l}=e;return(0,a.jsxs)(O,{children:[(0,a.jsx)(L,{}),(0,a.jsxs)(k.UC,{ref:s,className:d("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...l,children:[r,(0,a.jsxs)(k.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(A.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});z.displayName=k.UC.displayName;let V=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:d("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};V.displayName="DialogHeader";let F=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:d("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};F.displayName="DialogFooter";let U=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(k.hE,{ref:s,className:d("text-lg font-semibold leading-none tracking-tight",t),...r})});U.displayName=k.hE.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(k.VY,{ref:s,className:d("text-sm text-muted-foreground",t),...r})}).displayName=k.VY.displayName;let M=r.forwardRef((e,s)=>{let{className:t,type:r,...l}=e;return(0,a.jsx)("input",{type:r,className:d("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...l})});M.displayName="Input";let _=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("textarea",{className:d("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...r})});_.displayName="Textarea";var q=t(6195),P=t(9827),J=t(3697),B=function(e){return e.IT="IT",e.HR="HR",e.LOGISTICS="ЛОГИСТИКА",e}({}),H=function(e){return e.NEW="НОВАЯ",e.IN_PROGRESS="В РАБОТЕ",e.COMPLETED="ЗАВЕРШЕНА",e.REJECTED="ОТКЛОНЕНА",e}({}),G=t(709);let Y=(0,P.v)()((0,G.Zr)((e,s)=>({departments:[],employees:[],requests:[],recommendations:[],users:[],currentUser:null,registerUser:(t,a,r,l,n)=>{if(s().users.find(e=>e.username===t))throw Error("Пользователь с таким именем уже существует");let i={id:(0,J.A)(),username:t,password:a,email:r,firstName:l,lastName:n,role:"user",createdAt:new Date};return e(e=>({users:[...e.users,i]})),i},loginUser:(t,a)=>{let r=s().users.find(e=>e.username===t&&e.password===a);return r?(e({currentUser:r}),r):null},logoutUser:()=>{e({currentUser:null})},getCurrentUser:()=>s().currentUser,addDepartment:(s,t,a,r)=>{let l={id:(0,J.A)(),name:s,description:t,level:a,parentId:r,employees:[],childDepartments:[]};return e(e=>{if(null===r)return{departments:[...e.departments,l]};let s=e=>e.map(e=>e.id===r?{...e,childDepartments:[...e.childDepartments,l]}:e.childDepartments.length>0?{...e,childDepartments:s(e.childDepartments)}:e);return{departments:s(e.departments)}}),l},updateDepartment:(s,t)=>{e(e=>{let a=e=>e.map(e=>e.id===s?{...e,...t,childDepartments:e.childDepartments,employees:e.employees}:e.childDepartments.length>0?{...e,childDepartments:a(e.childDepartments)}:e);return{departments:a(e.departments)}})},deleteDepartment:s=>{e(e=>{e.employees.filter(e=>e.departmentId===s);let t=e.employees.map(e=>e.departmentId===s?{...e,departmentId:null}:e),a=e=>e.filter(e=>e.id!==s).map(e=>({...e,childDepartments:a(e.childDepartments)}));return{departments:a(e.departments),employees:t}})},moveDepartment:(t,a)=>{let r=s().getDepartmentById(t);if(!r)return;let l={...r};s().deleteDepartment(t),e(e=>{if(null===a)return{departments:[...e.departments,l]};let s=e=>e.map(e=>e.id===a?{...e,childDepartments:[...e.childDepartments,l]}:e.childDepartments.length>0?{...e,childDepartments:s(e.childDepartments)}:e);return{departments:s(e.departments)}})},addEmployee:t=>{let a=(0,J.A)(),r="".concat(t.name," ").concat(t.surname),l={...t,id:a,fullName:r,rating:t.rating||Math.floor(5*Math.random())+1};return e(e=>({employees:[...e.employees,l]})),t.departmentId&&s().moveEmployee(a,t.departmentId),l},updateEmployee:(t,a)=>{e(e=>({employees:e.employees.map(e=>e.id===t?{...e,...a}:e)}));let r=s().getEmployeeById(t);r&&r.departmentId&&e(e=>{let s=e=>e.map(e=>e.id===r.departmentId?{...e,employees:e.employees.map(e=>e.id===t?{...e,...a}:e)}:e.childDepartments.length>0?{...e,childDepartments:s(e.childDepartments)}:e);return{departments:s(e.departments)}})},deleteEmployee:t=>{let a=s().getEmployeeById(t);e(e=>({employees:e.employees.filter(e=>e.id!==t)})),a&&a.departmentId&&e(e=>{let s=e=>e.map(e=>e.id===a.departmentId?{...e,employees:e.employees.filter(e=>e.id!==t)}:e.childDepartments.length>0?{...e,childDepartments:s(e.childDepartments)}:e);return{departments:s(e.departments)}})},moveEmployee:(t,a)=>{let r=s().getEmployeeById(t);r&&(s().updateEmployee(t,{departmentId:a}),e(e=>{if(r.departmentId){let s=e=>e.map(e=>e.id===r.departmentId?{...e,employees:e.employees.filter(e=>e.id!==t)}:e.childDepartments.length>0?{...e,childDepartments:s(e.childDepartments)}:e);return{departments:s(e.departments)}}return{}}),a&&e(e=>{let s=e=>e.map(e=>e.id===a?{...e,employees:[...e.employees,{...r,departmentId:a}]}:e.childDepartments.length>0?{...e,childDepartments:s(e.childDepartments)}:e);return{departments:s(e.departments)}}))},addRequest:(s,t,a,r)=>{let l={id:(0,J.A)(),title:s,description:t,type:a,status:H.NEW,createdAt:new Date,updatedAt:new Date,createdById:r,assignedToDepartmentId:"",comments:[]};return e(e=>({requests:[...e.requests,l]})),l},updateRequestStatus:(s,t)=>{e(e=>({requests:e.requests.map(e=>e.id===s?{...e,status:t,updatedAt:new Date}:e)}))},assignRequest:(s,t,a)=>{e(e=>({requests:e.requests.map(e=>e.id===s?{...e,assignedToDepartmentId:t,assignedToEmployeeId:a,updatedAt:new Date,status:e.status===H.NEW?H.IN_PROGRESS:e.status}:e)}))},addRequestComment:(s,t,a)=>{let r={id:(0,J.A)(),text:t,createdAt:new Date,authorId:a,requestId:s};return e(e=>({requests:e.requests.map(e=>e.id===s?{...e,comments:[...e.comments,r],updatedAt:new Date}:e)})),r},addRecommendation:(s,t,a)=>{let r={id:(0,J.A)(),type:s,description:t,targetDepartmentId:a,createdAt:new Date,implemented:!1};return e(e=>({recommendations:[...e.recommendations,r]})),r},implementRecommendation:s=>{e(e=>({recommendations:e.recommendations.map(e=>e.id===s?{...e,implemented:!0}:e)}))},importEmployees:s=>{let t=s.map(e=>({...e,id:(0,J.A)()}));e(e=>({employees:[...e.employees,...t]})),t.forEach(s=>{s.departmentId&&e(e=>{let t=e=>e.map(e=>e.id===s.departmentId?{...e,employees:[...e.employees,s]}:e.childDepartments.length>0?{...e,childDepartments:t(e.childDepartments)}:e);return{departments:t(e.departments)}})})},getDepartmentById:e=>{let t=s=>{for(let a of s){if(a.id===e)return a;let s=t(a.childDepartments);if(s)return s}};return t(s().departments)},getEmployeeById:e=>s().employees.find(s=>s.id===e),getRequestById:e=>s().requests.find(s=>s.id===e),getTopEmployeesForDepartment:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,a=(e,s)=>{for(let t of e){if(t.id===s)return t;let e=a(t.childDepartments,s);if(e)return e}},r=a(s().departments,e);return r?[...r.employees].sort((e,s)=>{let t=e.rating||0;return(s.rating||0)-t}).slice(0,t):[]}}),{name:"organization-store"}));var W=t(9606),Z=t(3415),K=t(5060);let X=0,$=new Map,Q=e=>{if($.has(e))return;let s=setTimeout(()=>{$.delete(e),ea({type:"REMOVE_TOAST",toastId:e})},1e6);$.set(e,s)},ee=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?Q(t):e.toasts.forEach(e=>{Q(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},es=[],et={toasts:[]};function ea(e){et=ee(et,e),es.forEach(e=>{e(et)})}function er(e){let{...s}=e,t=(X=(X+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>ea({type:"DISMISS_TOAST",toastId:t});return ea({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>ea({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function el(){let[e,s]=r.useState(et);return r.useEffect(()=>(es.push(s),()=>{let e=es.indexOf(s);e>-1&&es.splice(e,1)}),[e]),{...e,toast:er,dismiss:e=>ea({type:"DISMISS_TOAST",toastId:e})}}let en=Z.z.object({name:Z.z.string().min(2,{message:"Название должно содержать как минимум 2 символа"}),description:Z.z.string().min(5,{message:"Описание должно содержать как минимум 5 символов"})});function ei(e){let{open:s,onOpenChange:t,department:r,parentId:l=null,mode:n}=e,{addDepartment:i,updateDepartment:d,getDepartmentById:c}=Y(),{toast:o}=el(),m=()=>{if("edit"===n&&r)return r.level;if(null===l)return 1;let e=c(l);return e?e.level+1:1},{register:u,handleSubmit:p,formState:{errors:x},reset:h}=(0,W.mN)({resolver:(0,K.u)(en),defaultValues:{name:(null==r?void 0:r.name)||"",description:(null==r?void 0:r.description)||""}});return(0,a.jsx)(T,{open:s,onOpenChange:t,children:(0,a.jsxs)(z,{className:"sm:max-w-[425px]",children:[(0,a.jsx)(V,{children:(0,a.jsx)(U,{children:(()=>{if("create"===n){if(null===l)return"Создать службу";let e=c(l),s=m();return"Создать ".concat(2===s?"отдел":"группу",' в "').concat((null==e?void 0:e.name)||"",'"')}return"Редактировать ".concat((null==r?void 0:r.name)||"отдел")})()})}),(0,a.jsxs)("form",{onSubmit:p(e=>{try{if("create"===n){let s=m();if(s>3){o({title:"Ошибка создания отдела",description:"Достигнут максимальный уровень вложенности (3)",variant:"destructive"});return}let t=i(e.name,e.description,s,l);o({title:"Отдел создан",description:"".concat(t.name," был успешно создан.")})}else"edit"===n&&r&&(d(r.id,{name:e.name,description:e.description}),o({title:"Отдел обновлен",description:"".concat(e.name," был успешно обновлен.")}));t(!1),h()}catch(e){o({title:"Ошибка",description:"Произошла ошибка при сохранении отдела.",variant:"destructive"})}}),className:"space-y-4 mt-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"name",children:"Название"}),(0,a.jsx)(M,{id:"name",...u("name"),placeholder:"Введите название отдела"}),x.name&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:x.name.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"description",children:"Описание"}),(0,a.jsx)(_,{id:"description",...u("description"),placeholder:"Введите описание отдела",rows:4}),x.description&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:x.description.message})]}),(0,a.jsxs)(F,{className:"mt-6",children:[(0,a.jsx)(b,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Отмена"}),(0,a.jsx)(b,{type:"submit",children:"create"===n?"Создать":"Сохранить"})]})]})]})})}var ed=t(2591),ec=t(5942),eo=t(4920);let em=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eo.bL,{ref:s,className:d("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...r})});em.displayName=eo.bL.displayName;let eu=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eo._V,{ref:s,className:d("aspect-square h-full w-full",t),...r})});eu.displayName=eo._V.displayName;let ep=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eo.H4,{ref:s,className:d("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...r})});ep.displayName=eo.H4.displayName;var ex=t(7321),eh=t(6039);function ef(e){let{rating:s,maxRating:t=5,size:r="md",onRatingChange:l,className:n,readOnly:i=!1}=e,c={sm:"w-3 h-3",md:"w-5 h-5",lg:"w-6 h-6"},o=e=>{i||null==l||l(e)};return(0,a.jsx)("div",{className:d("flex space-x-1",n),children:Array.from({length:t}).map((e,t)=>{let l=t+1,n=l<=s;return(0,a.jsx)(eh.A,{className:d(c[r],n?"text-yellow-400 fill-yellow-400":"text-gray-300",!i&&"cursor-pointer hover:scale-110 transition-transform"),onClick:()=>o(l)},t)})})}function ej(e){let s,t,{employee:r,onEdit:l,onDelete:n,onMove:i,showRating:d=!0,showControls:c=!0}=e,{updateEmployee:o}=Y();return(0,a.jsxs)(p,{className:"w-full max-w-sm hover:shadow-md transition-shadow",children:[(0,a.jsxs)(x,{className:"flex flex-row items-center gap-4 pb-2",children:[(0,a.jsx)(em,{className:(e=>{let s=["bg-blue-500","bg-green-500","bg-yellow-500","bg-red-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-orange-500"],t=e.split("").reduce((e,s)=>e+s.charCodeAt(0),0)%s.length;return s[t]})(r.name),children:r.photoUrl?(0,a.jsx)(eu,{src:r.photoUrl,alt:r.fullName||r.name}):(0,a.jsx)(ep,{children:(s=r.name,t=r.surname,(s[0]+(t?t[0]:"")).toUpperCase())})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(h,{className:"text-lg",children:r.fullName||"".concat(r.name," ").concat(r.surname)}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:r.position}),d&&(0,a.jsx)(ef,{rating:r.rating||0,size:"sm",className:"mt-1",onRatingChange:e=>{o(r.id,{rating:e})}})]})]}),(0,a.jsx)(j,{className:"pb-2",children:(0,a.jsxs)("div",{className:"space-y-2",children:[r.description&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:r.description}),(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Email:"})," ",r.email]}),r.phone&&(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Телефон:"})," ",r.phone]}),r.skills.length>0&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-1",children:"Навыки:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:r.skills.map((e,s)=>(0,a.jsx)("span",{className:"px-2 py-1 bg-secondary text-secondary-foreground rounded-md text-xs",children:e},s))})]})]})}),c&&(0,a.jsxs)(g,{className:"flex justify-between pt-2",children:[(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(b,{variant:"outline",size:"icon",onClick:l,children:(0,a.jsx)(D.A,{className:"h-4 w-4"})}),(0,a.jsx)(b,{variant:"outline",size:"icon",onClick:n,children:(0,a.jsx)(E.A,{className:"h-4 w-4"})})]}),(0,a.jsx)(b,{variant:"outline",size:"icon",onClick:i,children:(0,a.jsx)(ex.A,{className:"h-4 w-4"})})]})]})}let eg=Z.z.object({name:Z.z.string().min(2,{message:"Имя должно содержать как минимум 2 символа"}),surname:Z.z.string().min(2,{message:"Фамилия должна содержать как минимум 2 символа"}),position:Z.z.string().min(2,{message:"Должность должна содержать как минимум 2 символа"}),email:Z.z.string().email({message:"Введите корректный email"}),phone:Z.z.string().optional(),photoUrl:Z.z.string().optional(),description:Z.z.string().optional(),skills:Z.z.string().optional()});function ev(e){var s;let{open:t,onOpenChange:l,employee:n,departmentId:i,mode:d}=e,{addEmployee:c,updateEmployee:o}=Y(),{toast:m}=el(),[u,p]=(0,r.useState)((null==n?void 0:n.rating)||0),{register:x,handleSubmit:h,formState:{errors:f},reset:j}=(0,W.mN)({resolver:(0,K.u)(eg),defaultValues:{name:(null==n?void 0:n.name)||"",surname:(null==n?void 0:n.surname)||"",position:(null==n?void 0:n.position)||"",email:(null==n?void 0:n.email)||"",phone:(null==n?void 0:n.phone)||"",photoUrl:(null==n?void 0:n.photoUrl)||"",description:(null==n?void 0:n.description)||"",skills:(null==n?void 0:null===(s=n.skills)||void 0===s?void 0:s.join(", "))||""}});return(0,a.jsx)(T,{open:t,onOpenChange:l,children:(0,a.jsxs)(z,{className:"sm:max-w-[600px]",children:[(0,a.jsx)(V,{children:(0,a.jsx)(U,{children:"create"===d?"Добавить сотрудника":"Редактировать сотрудника: ".concat(null==n?void 0:n.name," ").concat(null==n?void 0:n.surname)})}),(0,a.jsxs)("form",{onSubmit:h(e=>{try{let s=e.skills?e.skills.split(",").map(e=>e.trim()).filter(Boolean):[],t={name:e.name,surname:e.surname,position:e.position,email:e.email,phone:e.phone||"",photoUrl:e.photoUrl||"",description:e.description||"",skills:s,rating:u};if("create"===d){let e=c({...t,departmentId:i});m({title:"Сотрудник создан",description:"".concat(e.name," ").concat(e.surname," был успешно добавлен в отдел.")})}else"edit"===d&&n&&(o(n.id,t),m({title:"Сотрудник обновлен",description:"Данные ".concat(e.name," ").concat(e.surname," были успешно обновлены.")}));l(!1),j()}catch(e){m({title:"Ошибка",description:"Произошла ошибка при сохранении сотрудника.",variant:"destructive"})}}),className:"space-y-4 mt-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"name",children:"Имя"}),(0,a.jsx)(M,{id:"name",...x("name"),placeholder:"Введите имя сотрудника"}),f.name&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:f.name.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"surname",children:"Фамилия"}),(0,a.jsx)(M,{id:"surname",...x("surname"),placeholder:"Введите фамилию сотрудника"}),f.surname&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:f.surname.message})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"position",children:"Должность"}),(0,a.jsx)(M,{id:"position",...x("position"),placeholder:"Введите должность сотрудника"}),f.position&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:f.position.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"photoUrl",children:"Фото (URL)"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(M,{id:"photoUrl",...x("photoUrl"),placeholder:"Введите URL фотографии сотрудника",className:"flex-1"}),(0,a.jsx)(b,{type:"button",variant:"outline",size:"icon",children:(0,a.jsx)(ec.A,{className:"h-4 w-4"})})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Укажите URL фотографии сотрудника или загрузите изображение"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"description",children:"Описание"}),(0,a.jsx)(_,{id:"description",...x("description"),placeholder:"Введите краткое описание сотрудника",rows:2})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{children:"Рейтинг сотрудника"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,a.jsx)(ef,{rating:u,size:"lg",onRatingChange:e=>{p(e)}}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground ml-2",children:[u," из 5"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"email",children:"Email"}),(0,a.jsx)(M,{id:"email",type:"email",...x("email"),placeholder:"Введите email сотрудника"}),f.email&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:f.email.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"phone",children:"Телефон"}),(0,a.jsx)(M,{id:"phone",type:"tel",...x("phone"),placeholder:"Введите телефон сотрудника (необязательно)"}),f.phone&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:f.phone.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"skills",children:"Навыки"}),(0,a.jsx)(_,{id:"skills",...x("skills"),placeholder:"Введите навыки сотрудника через запятую",rows:3}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Например: Excel, Word, Анализ данных, Переговоры"}),f.skills&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:f.skills.message})]}),(0,a.jsxs)(F,{className:"mt-6",children:[(0,a.jsx)(b,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Отмена"}),(0,a.jsx)(b,{type:"submit",children:"create"===d?"Создать":"Сохранить"})]})]})]})})}var eN=t(9957),ey=t(2488),eb=t(7193);let ew=eN.bL;eN.YJ;let eC=eN.WT,eS=r.forwardRef((e,s)=>{let{className:t,children:r,...l}=e;return(0,a.jsxs)(eN.l9,{ref:s,className:d("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...l,children:[r,(0,a.jsx)(eN.In,{asChild:!0,children:(0,a.jsx)(w.A,{className:"h-4 w-4 opacity-50"})})]})});eS.displayName=eN.l9.displayName;let eD=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eN.PP,{ref:s,className:d("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(ey.A,{className:"h-4 w-4"})})});eD.displayName=eN.PP.displayName;let eE=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eN.wn,{ref:s,className:d("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(w.A,{className:"h-4 w-4"})})});eE.displayName=eN.wn.displayName;let eI=r.forwardRef((e,s)=>{let{className:t,children:r,position:l="popper",...n}=e;return(0,a.jsx)(eN.ZL,{children:(0,a.jsxs)(eN.UC,{ref:s,className:d("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,...n,children:[(0,a.jsx)(eD,{}),(0,a.jsx)(eN.LM,{className:d("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(eE,{})]})})});eI.displayName=eN.UC.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eN.JU,{ref:s,className:d("px-2 py-1.5 text-sm font-semibold",t),...r})}).displayName=eN.JU.displayName;let eR=r.forwardRef((e,s)=>{let{className:t,children:r,...l}=e;return(0,a.jsxs)(eN.q7,{ref:s,className:d("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...l,children:[(0,a.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(eN.VF,{children:(0,a.jsx)(eb.A,{className:"h-4 w-4"})})}),(0,a.jsx)(eN.p4,{children:r})]})});function ek(e){var s;let{open:t,onOpenChange:l,employee:n,currentDepartmentId:i}=e,{departments:d,moveEmployee:c}=Y(),{toast:o}=el(),[m,u]=(0,r.useState)(null),[p,x]=(0,r.useState)([]);(0,r.useEffect)(()=>{let e=function(s){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(let a of s)t.push({id:a.id,name:a.name,level:a.level}),a.childDepartments.length>0&&e(a.childDepartments,t);return t};x(e(d).filter(e=>e.id!==i))},[d,i]);let h=e=>{switch(e){case 1:return"Служба";case 2:return"Отдел";case 3:return"Группа";default:return"Подразделение"}};return(0,a.jsx)(T,{open:t,onOpenChange:l,children:(0,a.jsxs)(z,{className:"sm:max-w-[425px]",children:[(0,a.jsx)(V,{children:(0,a.jsx)(U,{children:"Переместить сотрудника"})}),(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("p",{className:"font-medium",children:["Сотрудник: ",n.name]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Текущий отдел: ",null===(s=d.flatMap(e=>[...e.childDepartments,e]).find(e=>e.id===i))||void 0===s?void 0:s.name]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"department",children:"Выберите новый отдел"}),p.length>0?(0,a.jsxs)(ew,{onValueChange:e=>u(e),value:m||void 0,children:[(0,a.jsx)(eS,{id:"department",children:(0,a.jsx)(eC,{placeholder:"Выберите отдел"})}),(0,a.jsx)(eI,{children:p.map(e=>(0,a.jsxs)(eR,{value:e.id,children:[e.name," (",h(e.level),")"]},e.id))})]}):(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Нет доступных отделов для перемещения"})]})]}),(0,a.jsxs)(F,{children:[(0,a.jsx)(b,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Отмена"}),(0,a.jsx)(b,{type:"button",onClick:()=>{if(!m){o({title:"Ошибка",description:"Выберите отдел для перемещения сотрудника.",variant:"destructive"});return}c(n.id,m),o({title:"Сотрудник перемещен",description:"".concat(n.name," был успешно перемещен в другой отдел.")}),l(!1)},disabled:!m||0===p.length,children:"Переместить"})]})]})})}eR.displayName=eN.q7.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eN.wv,{ref:s,className:d("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=eN.wv.displayName;var eA=t(9159),eT=t.n(eA);function eO(e){try{let s=eT().parse(e,{header:!0,skipEmptyLines:!0}),t=[],a=(s.meta.fields||[]).map(e=>e.toLowerCase().trim()),r=["name","position","email"].filter(e=>{let s={name:["фио","имя","ф.и.о.","фамилия имя отчество"],position:["должность","позиция"],email:["электронная почта","почта"]};return!a.some(t=>{var a;return t===e||(null===(a=s[e])||void 0===a?void 0:a.includes(t))})});if(r.length>0&&t.push("Отсутствуют обязательные поля: ".concat(r.join(", "))),s.data.forEach((e,s)=>{let a=s+2;e.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)&&t.push("Строка ".concat(a,': Некорректный формат email "').concat(e.email,'"')),e.name&&""!==e.name.trim()||t.push("Строка ".concat(a,": Имя не указано")),e.position&&""!==e.position.trim()||t.push("Строка ".concat(a,": Должность не указана"))}),t.length>0)return{isValid:!1,errors:t};let l=function(e){let s=eT().parse(e,{header:!0,skipEmptyLines:!0,transformHeader:e=>{let s=e.toLowerCase().trim();return({фио:"name",имя:"name","ф.и.о.":"name","фамилия имя отчество":"name",должность:"position",позиция:"position","электронная почта":"email",email:"email",почта:"email",телефон:"phone",тел:"phone","тел.":"phone",навыки:"skills",компетенции:"skills",умения:"skills",отдел:"department",департамент:"department",подразделение:"department"})[s]||s}});if(s.errors.length>0)throw console.error("Ошибка при парсинге CSV:",s.errors),Error("Ошибка при парсинге CSV: ".concat(s.errors[0].message));return s.data.map(e=>{var s;return{name:e.name||"Не указано",position:e.position||"Не указано",email:e.email||"",phone:e.phone||"",skills:(s=e.skills||"")?s.split(/[,;]/).map(e=>e.trim()).filter(Boolean):[],departmentId:null}})}(e);return{isValid:!0,errors:[],data:l}}catch(e){return{isValid:!1,errors:[e.message||"Ошибка при проверке CSV-файла"]}}}var eL=t(1342),ez=t(1680);function eV(e){var s;let{open:t,onOpenChange:l,departmentId:n}=e,{importEmployees:i}=Y(),{toast:d}=el(),[c,o]=(0,r.useState)(""),[m,u]=(0,r.useState)(null),[p,x]=(0,r.useState)(!1),h=(0,r.useRef)(null);return(0,a.jsx)(T,{open:t,onOpenChange:l,children:(0,a.jsxs)(z,{className:"sm:max-w-[600px]",children:[(0,a.jsx)(V,{children:(0,a.jsx)(U,{children:"Импорт сотрудников из CSV"})}),(0,a.jsxs)("div",{className:"py-4 space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(b,{type:"button",variant:"outline",onClick:()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.click()},children:[(0,a.jsx)(ec.A,{className:"h-4 w-4 mr-2"}),"Загрузить CSV файл"]}),(0,a.jsx)("input",{type:"file",accept:".csv",ref:h,className:"hidden",onChange:e=>{var s;let t=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!t)return;let a=new FileReader;a.onload=e=>{var s;o(null===(s=e.target)||void 0===s?void 0:s.result),u(null)},a.readAsText(t)}}),(0,a.jsxs)("div",{className:"space-x-2",children:[(0,a.jsx)(b,{type:"button",variant:"outline",onClick:()=>{x(!0);try{let s=eO(c);if(u(s),s.isValid){var e;d({title:"Проверка успешна",description:"Найдено ".concat((null===(e=s.data)||void 0===e?void 0:e.length)||0," сотрудников для импорта.")})}else d({title:"Ошибки в CSV файле",description:"Исправьте ошибки перед импортом.",variant:"destructive"})}catch(e){d({title:"Ошибка валидации",description:e.message||"Не удалось обработать CSV",variant:"destructive"})}finally{x(!1)}},disabled:!c.trim()||p,children:"Проверить"}),(0,a.jsx)(b,{type:"button",onClick:()=>{x(!0);try{if(m&&m.isValid&&m.data){let e=m.data.map(e=>({...e,departmentId:n}));i(e)}else{let e=eO(c);if(!e.isValid){d({title:"Ошибки в CSV файле",description:"Пожалуйста, сначала исправьте ошибки и выполните проверку.",variant:"destructive"}),u(e),x(!1);return}if(u(e),!e.data||0===e.data.length){d({title:"Нет данных для импорта",description:"CSV не содержит данных о сотрудниках.",variant:"destructive"}),x(!1);return}let s=e.data.map(e=>({...e,departmentId:n}));i(s)}d({title:"Импорт выполнен",description:"Сотрудники успешно импортированы в отдел."}),o(""),u(null),l(!1)}catch(e){d({title:"Ошибка импорта",description:e.message||"Не удалось импортировать сотрудников",variant:"destructive"})}finally{x(!1)}},disabled:!(null==m?void 0:m.isValid)&&null!==m||!c.trim()||p,children:"Импортировать"})]})]}),(0,a.jsx)(_,{value:c,onChange:e=>{o(e.target.value),u(null)},placeholder:"Введите или вставьте CSV данные. Пример:\n".concat('ФИО,Должность,Email,Телефон,Навыки\nИванов Иван Иванович,Менеджер,ivanov@example.com,+7 (123) 456-78-90,"MS Word, Excel, PowerPoint"\nПетрова Анна Сергеевна,Дизайнер,petrova@example.com,+7 (987) 654-32-10,"Photoshop, Illustrator, Figma"'),className:"h-[200px] font-mono text-sm"}),m&&(0,a.jsx)("div",{className:"p-4 rounded-md ".concat(m.isValid?"bg-green-50":"bg-red-50"),children:(0,a.jsxs)("div",{className:"flex items-start",children:[m.isValid?(0,a.jsx)(eL.A,{className:"h-5 w-5 text-green-500 mr-2"}):(0,a.jsx)(ez.A,{className:"h-5 w-5 text-red-500 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium",children:m.isValid?"Проверка пройдена: найдено ".concat(null===(s=m.data)||void 0===s?void 0:s.length," сотрудников"):"Обнаружены ошибки"}),!m.isValid&&m.errors.length>0&&(0,a.jsx)("ul",{className:"mt-2 text-sm text-red-600 list-disc list-inside",children:m.errors.map((e,s)=>(0,a.jsx)("li",{children:e},s))})]})]})}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Требования к CSV файлу:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside",children:[(0,a.jsx)("li",{children:"Разделитель - запятая (,)"}),(0,a.jsx)("li",{children:"Должны быть указаны заголовки колонок"}),(0,a.jsx)("li",{children:"Обязательные поля: ФИО (или Имя), Должность, Email"}),(0,a.jsx)("li",{children:"Навыки следует указывать через запятую, в двойных кавычках"})]})]})]}),(0,a.jsx)(F,{children:(0,a.jsx)(b,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Отмена"})})]})})}function eF(e){let{open:s,onOpenChange:t,department:l}=e,{getEmployeeById:n,deleteEmployee:i}=Y(),{toast:d}=el(),[p,x]=(0,r.useState)(""),[h,f]=(0,r.useState)(!1),[j,g]=(0,r.useState)(!1),[v,N]=(0,r.useState)(!1),[y,w]=(0,r.useState)(!1),[C,S]=(0,r.useState)(null),D=l.employees.filter(e=>{let s=p.toLowerCase();return e.name.toLowerCase().includes(s)||e.position.toLowerCase().includes(s)||e.email.toLowerCase().includes(s)||e.skills.some(e=>e.toLowerCase().includes(s))}),E=()=>{S(null),f(!0)},R=e=>{S(e),g(!0)},k=e=>{S(e),N(!0)},A=e=>{confirm("Вы уверены, что хотите удалить сотрудника ".concat(e.name,"?"))&&(i(e.id),d({title:"Сотрудник удален",description:"".concat(e.name," был успешно удален из отдела.")}))};return(0,a.jsxs)(T,{open:s,onOpenChange:t,children:[(0,a.jsxs)(z,{className:"sm:max-w-[700px]",children:[(0,a.jsx)(V,{children:(0,a.jsxs)(U,{children:["Управление сотрудниками: ",l.name]})}),(0,a.jsxs)(c,{defaultValue:"list",className:"mt-4",children:[(0,a.jsxs)(o,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(m,{value:"list",children:"Список сотрудников"}),(0,a.jsx)(m,{value:"add",children:"Добавление сотрудников"})]}),(0,a.jsxs)(u,{value:"list",className:"space-y-4 mt-4",children:[(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(ed.A,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(M,{placeholder:"Поиск сотрудников...",value:p,onChange:e=>x(e.target.value),className:"pl-8"})]})}),(0,a.jsx)("div",{className:"h-[400px] overflow-y-auto pr-2",children:D.length>0?(0,a.jsx)("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2",children:D.map(e=>(0,a.jsx)(ej,{employee:e,onEdit:()=>R(e),onDelete:()=>A(e),onMove:()=>k(e)},e.id))}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center text-muted-foreground",children:[(0,a.jsx)("p",{className:"mb-2",children:p?"Нет сотрудников, соответствующих поисковому запросу":"В этом отделе еще нет сотрудников"}),!p&&(0,a.jsxs)(b,{variant:"outline",onClick:E,className:"mt-2",children:[(0,a.jsx)(I.A,{className:"h-4 w-4 mr-2"}),"Добавить сотрудника"]})]})})]}),(0,a.jsx)(u,{value:"add",className:"space-y-4 mt-4",children:(0,a.jsxs)("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"border rounded-lg p-6 flex flex-col items-center justify-center text-center cursor-pointer hover:bg-secondary transition-colors",onClick:E,children:[(0,a.jsx)(I.A,{className:"h-10 w-10 mb-4 text-primary"}),(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Добавить сотрудника"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Создать нового сотрудника в отделе"})]}),(0,a.jsxs)("div",{className:"border rounded-lg p-6 flex flex-col items-center justify-center text-center cursor-pointer hover:bg-secondary transition-colors",onClick:()=>{w(!0)},children:[(0,a.jsx)(ec.A,{className:"h-10 w-10 mb-4 text-primary"}),(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Импорт из CSV"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Загрузить список сотрудников из CSV-файла"})]})]})})]}),(0,a.jsx)(F,{className:"mt-6",children:(0,a.jsx)(b,{onClick:()=>t(!1),children:"Закрыть"})})]}),(0,a.jsx)(ev,{open:h,onOpenChange:f,departmentId:l.id,mode:"create"}),C&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ev,{open:j,onOpenChange:g,employee:C,departmentId:l.id,mode:"edit"}),(0,a.jsx)(ek,{open:v,onOpenChange:N,employee:C,currentDepartmentId:l.id})]}),(0,a.jsx)(eV,{open:y,onOpenChange:w,departmentId:l.id})]})}function eU(){let{departments:e,addDepartment:s,updateDepartment:t,deleteDepartment:l}=Y(),{toast:n}=el(),[i,d]=(0,r.useState)(new Set),[c,o]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1),[f,g]=(0,r.useState)(!1),[v,N]=(0,r.useState)(null),[y,w]=(0,r.useState)(null),C=e=>{let s=new Set(i);s.has(e)?s.delete(e):s.add(e),d(s)},S=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;w(e),N(null),o(!0)},D=e=>{N(e),u(!0)},E=e=>{if(e.employees.length>0||e.childDepartments.length>0){n({title:"Невозможно удалить",description:"Отдел содержит сотрудников или подразделения. Сначала удалите их.",variant:"destructive"});return}l(e.id),n({title:"Отдел удален",description:"".concat(e.name," был успешно удален.")})},k=e=>{N(e),g(!0)},A=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,a.jsx)("div",{className:"ml-".concat(8*(s>0)," space-y-4 mt-4"),children:e.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsx)(R,{department:e,isExpanded:i.has(e.id),onToggleExpand:()=>C(e.id),onEdit:()=>D(e),onDelete:()=>E(e),onAddSubdepartment:()=>S(e.id),onManageEmployees:()=>k(e)}),i.has(e.id)&&e.childDepartments.length>0&&A(e.childDepartments,s+1)]},e.id))})};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(p,{children:[(0,a.jsx)(x,{children:(0,a.jsx)(h,{className:"text-xl",children:"Организационная структура"})}),(0,a.jsxs)(j,{children:[(0,a.jsx)("div",{className:"flex justify-end mb-4",children:(0,a.jsxs)(b,{onClick:()=>S(null),children:[(0,a.jsx)(I.A,{className:"h-4 w-4 mr-2"}),"Добавить службу"]})}),0===e.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:(0,a.jsx)("p",{children:"Организационная структура пуста. Создайте первый отдел."})}):A(e)]})]}),(0,a.jsx)(ei,{open:c,onOpenChange:o,parentId:y,mode:"create"}),v&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ei,{open:m,onOpenChange:u,department:v,mode:"edit"}),(0,a.jsx)(eF,{open:f,onOpenChange:g,department:v})]})]})}let eM=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:s,className:d("w-full caption-bottom text-sm",t),...r})})});eM.displayName="Table";let e_=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("thead",{ref:s,className:d("[&_tr]:border-b",t),...r})});e_.displayName="TableHeader";let eq=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tbody",{ref:s,className:d("[&_tr:last-child]:border-0",t),...r})});eq.displayName="TableBody",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tfoot",{ref:s,className:d("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r})}).displayName="TableFooter";let eP=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("tr",{ref:s,className:d("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r})});eP.displayName="TableRow";let eJ=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("th",{ref:s,className:d("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r})});eJ.displayName="TableHead";let eB=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("td",{ref:s,className:d("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r})});eB.displayName="TableCell",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("caption",{ref:s,className:d("mt-4 text-sm text-muted-foreground",t),...r})}).displayName="TableCaption";let eH=(0,N.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function eG(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:d(eH({variant:t}),s),...r})}function eY(e){let{open:s,onOpenChange:t,request:l}=e,{departments:n,updateRequestStatus:i,assignRequest:d,addRequestComment:c}=Y(),{toast:o}=el(),[m,u]=(0,r.useState)(l.status),[f,g]=(0,r.useState)(l.assignedToDepartmentId||""),[v,N]=(0,r.useState)(""),[y,w]=(0,r.useState)(!1),C=r.useMemo(()=>{let e=[],s=t=>{t.forEach(t=>{e.push({id:t.id,name:t.name,level:t.level}),t.childDepartments&&t.childDepartments.length>0&&s(t.childDepartments)})};return s(n),e},[n]),S=e=>new Intl.DateTimeFormat("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(e);return(0,a.jsx)(T,{open:s,onOpenChange:t,children:(0,a.jsxs)(z,{className:"sm:max-w-[650px]",children:[(0,a.jsx)(V,{children:(0,a.jsxs)(U,{children:["Детали заявки: ",l.title]})}),(0,a.jsxs)("div",{className:"py-4 space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,a.jsx)(eG,{className:(e=>{switch(e){case H.NEW:return"bg-blue-100 text-blue-800";case H.IN_PROGRESS:return"bg-yellow-100 text-yellow-800";case H.COMPLETED:return"bg-green-100 text-green-800";case H.REJECTED:return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(l.status),children:l.status}),(0,a.jsx)(eG,{variant:"outline",children:(e=>{switch(e){case B.IT:return"ИТ-запрос";case B.HR:return"Кадровый вопрос";case B.LOGISTICS:return"Запрос логистики";default:return e}})(l.type)}),(0,a.jsxs)(eG,{variant:"outline",className:"bg-slate-50",children:["Создано: ",S(l.createdAt)]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium mb-1",children:"Описание:"}),(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:l.description})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium mb-1",children:"Назначено:"}),(0,a.jsx)("p",{className:"text-sm",children:(e=>{let s=C.find(s=>s.id===e);return(null==s?void 0:s.name)||"Не назначен"})(l.assignedToDepartmentId)})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Комментарии:"}),l.comments.length>0?(0,a.jsx)("div",{className:"space-y-3 mb-4 max-h-[200px] overflow-y-auto",children:l.comments.map(e=>(0,a.jsxs)(p,{className:"p-0",children:[(0,a.jsx)(x,{className:"p-3 pb-2",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(h,{className:"text-sm",children:"Пользователь"}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:S(e.createdAt)})]})}),(0,a.jsx)(j,{className:"p-3 pt-0",children:(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.text})})]},e.id))}):(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Нет комментариев"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"comment",children:"Добавить комментарий"}),(0,a.jsx)(_,{id:"comment",value:v,onChange:e=>N(e.target.value),placeholder:"Введите комментарий к заявке...",rows:3}),(0,a.jsx)(b,{type:"button",onClick:()=>{if(!v.trim()){o({title:"Ошибка",description:"Введите текст комментария.",variant:"destructive"});return}w(!0);try{c(l.id,v,"system-user"),o({title:"Комментарий добавлен",description:"Ваш комментарий был успешно добавлен к заявке."}),N("")}catch(e){o({title:"Ошибка",description:"Не удалось добавить комментарий.",variant:"destructive"})}finally{w(!1)}},disabled:y||!v.trim(),className:"mt-2",children:"Добавить комментарий"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"status",children:"Изменить статус"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(ew,{value:m,onValueChange:e=>u(e),children:[(0,a.jsx)(eS,{id:"status",children:(0,a.jsx)(eC,{placeholder:"Выберите статус"})}),(0,a.jsx)(eI,{children:Object.values(H).map(e=>(0,a.jsx)(eR,{value:e,children:e},e))})]}),(0,a.jsx)(b,{type:"button",onClick:()=>{w(!0);try{i(l.id,m),o({title:"Статус обновлен",description:"Статус заявки изменен на ".concat(m,".")})}catch(e){o({title:"Ошибка",description:"Не удалось обновить статус заявки.",variant:"destructive"})}finally{w(!1)}},disabled:y||m===l.status,children:"Обновить"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"department",children:"Назначить отдел"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(ew,{value:f,onValueChange:g,children:[(0,a.jsx)(eS,{id:"department",children:(0,a.jsx)(eC,{placeholder:"Выберите отдел"})}),(0,a.jsx)(eI,{children:C.map(e=>(0,a.jsx)(eR,{value:e.id,children:e.name},e.id))})]}),(0,a.jsx)(b,{type:"button",onClick:()=>{w(!0);try{d(l.id,f);let e=C.find(e=>e.id===f);o({title:"Отдел назначен",description:'Заявка назначена отделу "'.concat((null==e?void 0:e.name)||"Неизвестный отдел",'".')})}catch(e){o({title:"Ошибка",description:"Не удалось назначить отдел для заявки.",variant:"destructive"})}finally{w(!1)}},disabled:y||f===l.assignedToDepartmentId||!f,children:"Назначить"})]})]})]})]}),(0,a.jsx)(F,{children:(0,a.jsx)(b,{type:"button",onClick:()=>t(!1),children:"Закрыть"})})]})})}let eW=e=>new Intl.DateTimeFormat("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(e),eZ=e=>{switch(e){case B.IT:return"ИТ-запрос";case B.HR:return"Кадровый вопрос";case B.LOGISTICS:return"Запрос логистики";default:return e}},eK=e=>{switch(e){case H.NEW:return"bg-blue-100 text-blue-800";case H.IN_PROGRESS:return"bg-yellow-100 text-yellow-800";case H.COMPLETED:return"bg-green-100 text-green-800";case H.REJECTED:return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};function eX(){let{requests:e,departments:s}=Y(),[t,l]=(0,r.useState)(""),[n,i]=(0,r.useState)("ALL"),[d,c]=(0,r.useState)("ALL"),[o,m]=(0,r.useState)(null),[u,f]=(0,r.useState)(!1),g=e.filter(e=>{if("ALL"!==n&&e.status!==n||"ALL"!==d&&e.type!==d)return!1;if(t){let s=t.toLowerCase();return e.title.toLowerCase().includes(s)||e.description.toLowerCase().includes(s)}return!0}),v=e=>{let t=e=>e.reduce((e,s)=>[...e,s,...t(s.childDepartments)],[]),a=t(s).find(s=>s.id===e);return a?a.name:"Не назначен"},N=e=>{m(e),f(!0)};return(0,a.jsxs)(p,{className:"w-full",children:[(0,a.jsx)(x,{children:(0,a.jsx)(h,{children:"Список заявок"})}),(0,a.jsxs)(j,{children:[(0,a.jsxs)("div",{className:"mb-4 flex flex-col sm:flex-row gap-4 items-end",children:[(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"search",children:"Поиск"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(ed.A,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(M,{id:"search",placeholder:"Поиск по заголовку или описанию...",value:t,onChange:e=>l(e.target.value),className:"pl-8"})]})]}),(0,a.jsxs)("div",{className:"w-full sm:w-48 space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"status-filter",children:"Статус"}),(0,a.jsxs)(ew,{value:n,onValueChange:e=>i(e),children:[(0,a.jsx)(eS,{id:"status-filter",children:(0,a.jsx)(eC,{placeholder:"Все статусы"})}),(0,a.jsxs)(eI,{children:[(0,a.jsx)(eR,{value:"ALL",children:"Все статусы"}),Object.values(H).map(e=>(0,a.jsx)(eR,{value:e,children:e},e))]})]})]}),(0,a.jsxs)("div",{className:"w-full sm:w-48 space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"type-filter",children:"Тип"}),(0,a.jsxs)(ew,{value:d,onValueChange:e=>c(e),children:[(0,a.jsx)(eS,{id:"type-filter",children:(0,a.jsx)(eC,{placeholder:"Все типы"})}),(0,a.jsxs)(eI,{children:[(0,a.jsx)(eR,{value:"ALL",children:"Все типы"}),Object.values(B).map(e=>(0,a.jsx)(eR,{value:e,children:eZ(e)},e))]})]})]})]}),0===g.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:(0,a.jsx)("p",{children:"Нет заявок, соответствующих критериям поиска и фильтрации"})}):(0,a.jsx)("div",{className:"border rounded-md overflow-hidden",children:(0,a.jsxs)(eM,{children:[(0,a.jsx)(e_,{children:(0,a.jsxs)(eP,{children:[(0,a.jsx)(eJ,{children:"ID"}),(0,a.jsx)(eJ,{children:"Заголовок"}),(0,a.jsx)(eJ,{children:"Тип"}),(0,a.jsx)(eJ,{children:"Статус"}),(0,a.jsx)(eJ,{children:"Отдел"}),(0,a.jsx)(eJ,{children:"Дата создания"}),(0,a.jsx)(eJ,{className:"text-right",children:"Действия"})]})}),(0,a.jsx)(eq,{children:g.map(e=>(0,a.jsxs)(eP,{children:[(0,a.jsxs)(eB,{className:"font-mono text-xs",children:[e.id.substring(0,8),"..."]}),(0,a.jsx)(eB,{className:"font-medium",children:e.title}),(0,a.jsx)(eB,{children:eZ(e.type)}),(0,a.jsx)(eB,{children:(0,a.jsx)(eG,{className:eK(e.status),children:e.status})}),(0,a.jsx)(eB,{children:v(e.assignedToDepartmentId)}),(0,a.jsx)(eB,{children:eW(e.createdAt)}),(0,a.jsx)(eB,{className:"text-right",children:(0,a.jsx)(b,{variant:"outline",size:"sm",onClick:()=>N(e),children:"Подробнее"})})]},e.id))})]})})]}),o&&(0,a.jsx)(eY,{open:u,onOpenChange:f,request:o})]})}let e$={[B.IT]:["компьютер","ноутбук","система","принтер","сканер","интернет","почта","почтовый","пароль","учетная запись","учетной записи","сервер","windows","офис","excel","word","powerpoint","outlook","программа","программное","приложение","установка","обновление","вирус","антивирус","настройка","подключение","доступ","логин","ip","it","ит","айти"],[B.HR]:["отпуск","больничный","hr","кадры","персонал","собеседование","прием","увольнение","сотрудник","сотрудника","коллега","коллеги","заявление","документ","справка","трудовая книжка","трудовой договор","контракт","испытательный срок","зарплата","оклад","премия","бонус","компенсация","отдел кадров","кадровый","обучение","тренинг","курс","повышение квалификации","аттестация","оценка"],[B.LOGISTICS]:["доставка","перевозка","транспорт","груз","склад","запас","отгрузка","поставка","заказ","логистика","курьер","экспедитор","посылка","накладная","товар","материал","сырье","поставщик","клиент","маршрут","машина","автомобиль","водитель","хранение","канцтовары","офисные","бумага","мебель","офисная техника"]},eQ=Z.z.object({title:Z.z.string().min(3,{message:"Заголовок должен содержать как минимум 3 символа"}),description:Z.z.string().min(10,{message:"Описание должно содержать как минимум 10 символов"}),type:Z.z.nativeEnum(B,{message:"Выберите тип заявки"})});function e0(e){let{onCreate:s,onCancel:t}=e,{departments:l}=Y(),{toast:n}=el(),[i,d]=(0,r.useState)(null);r.useMemo(()=>{let e=[],s=t=>{t.forEach(t=>{e.push({id:t.id,name:t.name,level:t.level}),t.childDepartments.length>0&&s(t.childDepartments)})};return s(l),e},[l]);let{register:c,handleSubmit:o,formState:{errors:m},watch:u,setValue:f,reset:v}=(0,W.mN)({resolver:(0,K.u)(eQ),defaultValues:{title:"",description:"",type:void 0}}),N=u("title"),y=u("description");(0,r.useEffect)(()=>{if(N&&y&&N.length>3&&y.length>10){let e=function(e,s){let t="".concat(e," ").concat(s).toLowerCase(),a={[B.IT]:0,[B.HR]:0,[B.LOGISTICS]:0},r={[B.IT]:e$[B.IT].length,[B.HR]:e$[B.HR].length,[B.LOGISTICS]:e$[B.LOGISTICS].length};Object.entries(e$).forEach(e=>{let[s,r]=e;for(let e of r)t.includes(e.toLowerCase())&&(a[s]+=1)});let l=0,n=null;if(Object.entries(a).forEach(e=>{let[s,t]=e;t>l&&(l=t,n=s)}),0===l||!n)return null;let i=t.split(/\s+/).length,d=Math.min(l/Math.min(r[n],i/3),1);return d<.2?null:{type:n,confidence:d}}(N,y);e?(d(e),e.confidence>.7&&f("type",e.type)):d(null)}},[N,y,f]);let w=e=>{switch(e){case B.IT:return"ИТ-запрос";case B.HR:return"Кадровый вопрос";case B.LOGISTICS:return"Запрос логистики";default:return e}};return(0,a.jsxs)(p,{className:"w-full",children:[(0,a.jsx)(x,{children:(0,a.jsx)(h,{children:"Создание новой заявки"})}),(0,a.jsx)(j,{children:(0,a.jsxs)("form",{onSubmit:o(e=>{s&&(s(e),v(),d(null))}),id:"request-form",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"title",children:"Заголовок"}),(0,a.jsx)(M,{id:"title",...c("title"),placeholder:"Введите краткий заголовок заявки"}),m.title&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:m.title.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"description",children:"Описание"}),(0,a.jsx)(_,{id:"description",...c("description"),placeholder:"Опишите вашу проблему или запрос подробно",rows:5}),m.description&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:m.description.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(q.J,{htmlFor:"type",children:"Тип заявки"}),(0,a.jsxs)(ew,{onValueChange:e=>f("type",e),value:u("type"),children:[(0,a.jsx)(eS,{id:"type",children:(0,a.jsx)(eC,{placeholder:"Выберите тип заявки"})}),(0,a.jsx)(eI,{children:Object.values(B).map(e=>(0,a.jsx)(eR,{value:e,children:w(e)},e))})]}),m.type&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:m.type.message}),i&&(0,a.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Автоклассификация: ",w(i.type),"(уверенность: ",Math.round(100*i.confidence),"%)"]}),(0,a.jsx)(b,{type:"button",variant:"link",size:"sm",className:"ml-2",onClick:()=>f("type",i.type),children:"Применить"})]})]})]})}),(0,a.jsxs)(g,{className:"flex justify-end space-x-2",children:[t&&(0,a.jsx)(b,{type:"button",variant:"outline",onClick:t,children:"Отмена"}),(0,a.jsx)(b,{type:"submit",form:"request-form",children:"Создать заявку"})]})]})}var e2=t(9930);let e1=e2.Kq,e4=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(e2.LM,{ref:s,className:d("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...r})});e4.displayName=e2.LM.displayName;let e5=(0,N.F)("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),e3=r.forwardRef((e,s)=>{let{className:t,variant:r,...l}=e;return(0,a.jsx)(e2.bL,{ref:s,className:d(e5({variant:r}),t),...l})});e3.displayName=e2.bL.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(e2.rc,{ref:s,className:d("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...r})}).displayName=e2.rc.displayName;let e8=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(e2.bm,{ref:s,className:d("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...r,children:(0,a.jsx)(A.A,{className:"h-4 w-4"})})});e8.displayName=e2.bm.displayName;let e6=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(e2.hE,{ref:s,className:d("text-sm font-semibold [&+div]:text-xs",t),...r})});e6.displayName=e2.hE.displayName;let e9=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(e2.VY,{ref:s,className:d("text-sm opacity-90",t),...r})});function e7(){let{toasts:e}=el();return(0,a.jsxs)(e1,{children:[e.map(e=>{let{id:s,title:t,description:r,action:l,...n}=e;return(0,a.jsxs)(e3,{...n,children:[(0,a.jsxs)("div",{className:"grid gap-1",children:[t&&(0,a.jsx)(e6,{children:t}),r&&(0,a.jsx)(e9,{children:r})]}),l,(0,a.jsx)(e8,{})]},s)}),(0,a.jsx)(e4,{})]})}e9.displayName=e2.VY.displayName;let se=(0,N.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ss=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(q.b,{ref:s,className:d(se(),t),...r})});ss.displayName=q.b.displayName;var st=t(4109),sa=t(8865),sr=t(282),sl=t(3713);function sn(){let{departments:e,recommendations:s,addRecommendation:t,implementRecommendation:l,getTopEmployeesForDepartment:n}=Y(),{toast:i}=el(),[d,c]=(0,r.useState)(""),[o,m]=(0,r.useState)("EMPLOYEE_DISTRIBUTION"),[u,g]=(0,r.useState)(!1),[v,N]=(0,r.useState)([]),y=r.useMemo(()=>{let s=[],t=e=>{for(let a of e)s.push({id:a.id,name:a.name,level:a.level}),a.childDepartments&&a.childDepartments.length>0&&t(a.childDepartments)};return t(e),s},[e]);(0,r.useEffect)(()=>{d?N(n(d,5)):N([])},[d,n]);let w=e=>{switch(e){case 1:return"Служба";case 2:return"Отдел";case 3:return"Группа";default:return""}},C=e=>{l(e),i({title:"Рекомендация внедрена",description:'Статус рекомендации изменен на "Внедрена".'})};return(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,a.jsxs)(p,{children:[(0,a.jsxs)(x,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(st.A,{className:"h-6 w-6 text-primary"}),(0,a.jsx)(h,{children:"ИИ-оптимизация структуры"})]}),(0,a.jsx)(f,{children:"Получите рекомендации по оптимизации организационной структуры на основе ИИ-анализа"})]}),(0,a.jsxs)(j,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ss,{htmlFor:"department",children:"Выберите отдел для анализа"}),(0,a.jsxs)(ew,{onValueChange:c,value:d,children:[(0,a.jsx)(eS,{id:"department",children:(0,a.jsx)(eC,{placeholder:"Выберите отдел"})}),(0,a.jsx)(eI,{children:y.map(e=>(0,a.jsx)(eR,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsx)(eG,{variant:"outline",children:w(e.level)})]})},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ss,{htmlFor:"optimization-type",children:"Тип оптимизации"}),(0,a.jsxs)(ew,{onValueChange:m,value:o,children:[(0,a.jsx)(eS,{id:"optimization-type",children:(0,a.jsx)(eC,{placeholder:"Выберите тип оптимизации"})}),(0,a.jsxs)(eI,{children:[(0,a.jsx)(eR,{value:"EMPLOYEE_DISTRIBUTION",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sa.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Распределение сотрудников"})]})}),(0,a.jsx)(eR,{value:"WORKLOAD_PREDICTION",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(sr.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Прогноз загрузки"})]})})]})]})]}),(0,a.jsx)(b,{onClick:()=>{if(!d){i({title:"Выберите отдел",description:"Для генерации рекомендации необходимо выбрать отдел.",variant:"destructive"});return}g(!0);try{let e="";e="EMPLOYEE_DISTRIBUTION"===o?function(e,s){let t=["Рекомендуется перераспределить сотрудников с учетом их компетенций для повышения эффективности. Предлагается перевести специалистов с техническими навыками в ИТ-отдел.","Обнаружен дисбаланс навыков в отделе. Рекомендуется обучение сотрудников новым компетенциям или реорганизация структуры.","Для оптимизации рабочих процессов рекомендуется создать новую группу сотрудников со специализацией в конкретных задачах.","Анализ показал, что в отделе недостаточно специалистов с навыками проектного управления. Рекомендуется добавить сотрудников с этими компетенциями.","Для повышения эффективности отдела рекомендуется равномерное распределение сотрудников с учетом их навыков и опыта."];return t[Math.floor(Math.random()*t.length)]}(0,0):function(e,s){let t=["Прогноз показывает увеличение загрузки отдела на 15% в следующем месяце. Рекомендуется подготовить дополнительные ресурсы.","Ожидается снижение количества заявок на 10% в следующие 2 недели. Можно временно перераспределить ресурсы на другие задачи.","Анализ истории заявок показывает циклическое увеличение нагрузки в конце квартала. Рекомендуется заранее планировать ресурсы.","Прогнозируется стабильная загрузка отдела в ближайший месяц. Текущих ресурсов достаточно для обработки ожидаемого объема заявок.","Данные указывают на возможные пиковые нагрузки в начале следующего месяца. Рекомендуется оптимизировать рабочие процессы."];return t[Math.floor(Math.random()*t.length)]}(0,0),t(o,e,d),i({title:"Рекомендация сгенерирована",description:"Новая рекомендация по оптимизации была успешно создана."})}catch(e){i({title:"Ошибка",description:"Не удалось сгенерировать рекомендацию. Пожалуйста, попробуйте еще раз.",variant:"destructive"})}finally{g(!1)}},className:"w-full mt-4",disabled:u||!d,children:u?"Генерация...":"Сгенерировать рекомендацию"})]}),(0,a.jsx)(x,{className:"pt-0",children:(0,a.jsx)(h,{className:"text-lg",children:"Существующие рекомендации"})}),(0,a.jsx)(j,{className:"space-y-4",children:s.length>0?(0,a.jsx)("div",{className:"space-y-4",children:s.map(e=>{let s=y.find(s=>s.id===e.targetDepartmentId);return(0,a.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-center mb-2",children:["EMPLOYEE_DISTRIBUTION"===e.type?(0,a.jsx)(sa.A,{className:"h-4 w-4 text-primary"}):(0,a.jsx)(sr.A,{className:"h-4 w-4 text-primary"}),(0,a.jsx)("h4",{className:"font-medium",children:"EMPLOYEE_DISTRIBUTION"===e.type?"Распределение сотрудников":"Прогноз загрузки"}),e.implemented&&(0,a.jsx)(eG,{variant:"success",className:"ml-auto bg-green-500 text-white",children:"Внедрено"})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:e.description}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Отдел:"}),(0,a.jsx)(eG,{variant:"outline",children:s?s.name:"Неизвестный отдел"})]}),!e.implemented&&(0,a.jsx)(b,{variant:"outline",size:"sm",onClick:()=>C(e.id),children:"Внедрить"})]})]},e.id)})}):(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"Нет рекомендаций. Создайте новую рекомендацию, выбрав отдел и тип оптимизации."})})]}),(0,a.jsxs)(p,{children:[(0,a.jsxs)(x,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(sl.A,{className:"h-6 w-6 text-yellow-500"}),(0,a.jsx)(h,{children:"Топ сотрудников отдела"})]}),(0,a.jsx)(f,{children:"Лучшие сотрудники выбранного отдела, отсортированные по рейтингу"})]}),(0,a.jsx)(j,{className:"space-y-4",children:v.length>0?(0,a.jsx)("div",{className:"space-y-6",children:v.map((e,s)=>(0,a.jsxs)("div",{className:"relative",children:[s<3&&(0,a.jsxs)("div",{className:"absolute -top-2 -right-2 z-10 w-8 h-8 rounded-full bg-yellow-500 flex items-center justify-center text-white font-bold text-sm shadow-md",children:["#",s+1]}),(0,a.jsx)(ej,{employee:e,showControls:!1})]},e.id))}):d?(0,a.jsx)("div",{className:"text-center py-16 text-muted-foreground",children:"В выбранном отделе нет сотрудников"}):(0,a.jsx)("div",{className:"text-center py-16 text-muted-foreground",children:"Выберите отдел, чтобы увидеть его лучших сотрудников"})})]})]})}function si(){let{departments:e,getTopEmployeesForDepartment:s}=Y(),[t,l]=(0,r.useState)(""),[n,i]=(0,r.useState)([]),d=r.useMemo(()=>{let s=[],t=e=>{for(let a of e)s.push({id:a.id,name:a.name,level:a.level}),a.childDepartments&&a.childDepartments.length>0&&t(a.childDepartments)};return t(e),s},[e]);(0,r.useEffect)(()=>{t?i(s(t,5)):i([])},[t,s]);let c=e=>{switch(e){case 1:return"Служба";case 2:return"Отдел";case 3:return"Группа";default:return""}};return(0,a.jsxs)(p,{children:[(0,a.jsxs)(x,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(sl.A,{className:"h-6 w-6 text-yellow-500"}),(0,a.jsx)(h,{children:"Топ сотрудников"})]}),(0,a.jsx)(f,{children:"Выберите отдел, чтобы увидеть его лучших сотрудников, отсортированных по рейтингу"})]}),(0,a.jsxs)(j,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ss,{htmlFor:"department",children:"Выберите отдел"}),(0,a.jsxs)(ew,{onValueChange:e=>{l(e)},value:t,children:[(0,a.jsx)(eS,{id:"department",children:(0,a.jsx)(eC,{placeholder:"Выберите отдел"})}),(0,a.jsx)(eI,{children:d.map(e=>(0,a.jsx)(eR,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsx)(eG,{variant:"outline",children:c(e.level)})]})},e.id))})]})]}),n.length>0?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Лучшие сотрудники:"}),(0,a.jsx)("div",{className:"grid gap-4 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3",children:n.map((e,s)=>(0,a.jsxs)("div",{className:"relative",children:[s<3&&(0,a.jsxs)("div",{className:"absolute -top-2 -left-2 z-10 w-8 h-8 rounded-full bg-yellow-500 flex items-center justify-center text-white font-bold text-sm shadow-md",children:["#",s+1]}),(0,a.jsx)(ej,{employee:e,showControls:!1})]},e.id))})]}):t?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"В выбранном отделе нет сотрудников"}):(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"Выберите отдел, чтобы увидеть топ сотрудников"})]})]})}var sd=t(2472);function sc(e){let{onRegisterClick:s}=e,[t,l]=(0,r.useState)(""),[n,i]=(0,r.useState)(""),[d,c]=(0,r.useState)(!1),{loginUser:o}=Y(),{toast:m}=el();return(0,a.jsxs)(p,{className:"w-[400px] shadow-md",children:[(0,a.jsxs)(x,{className:"space-y-1",children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-2",children:(0,a.jsx)("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:(0,a.jsx)(sd.A,{className:"h-6 w-6 text-primary"})})}),(0,a.jsx)(h,{className:"text-2xl text-center",children:"Вход в систему"}),(0,a.jsx)(f,{className:"text-center",children:"Введите свои данные для входа в систему"})]}),(0,a.jsx)(j,{className:"space-y-4",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),c(!0);try{let e=o(t,n);e?m({title:"Успешный вход",description:"Добро пожаловать, ".concat(e.firstName||e.username,"!")}):m({title:"Ошибка входа",description:"Неверное имя пользователя или пароль",variant:"destructive"})}catch(e){m({title:"Ошибка",description:"Произошла ошибка при входе в систему",variant:"destructive"})}finally{c(!1)}},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ss,{htmlFor:"username",children:"Имя пользователя"}),(0,a.jsx)(M,{id:"username",placeholder:"Введите имя пользователя",value:t,onChange:e=>l(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ss,{htmlFor:"password",children:"Пароль"}),(0,a.jsx)(M,{id:"password",type:"password",placeholder:"Введите пароль",value:n,onChange:e=>i(e.target.value),required:!0})]}),(0,a.jsx)(b,{type:"submit",className:"w-full",disabled:d,children:d?"Вход...":"Войти"})]})}),(0,a.jsx)(g,{className:"flex flex-col space-y-4",children:(0,a.jsxs)("div",{className:"text-sm text-center text-muted-foreground",children:["Еще нет аккаунта?"," ",(0,a.jsx)(b,{variant:"link",className:"p-0",onClick:s,children:"Зарегистрируйтесь"})]})})]})}var so=t(4659);function sm(e){let{onLoginClick:s}=e,[t,l]=(0,r.useState)({username:"",password:"",confirmPassword:"",email:"",firstName:"",lastName:""}),[n,i]=(0,r.useState)(!1),{registerUser:d,loginUser:c}=Y(),{toast:o}=el(),m=e=>{let{name:s,value:a}=e.target;l({...t,[s]:a})};return(0,a.jsxs)(p,{className:"w-[450px] shadow-md",children:[(0,a.jsxs)(x,{className:"space-y-1",children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-2",children:(0,a.jsx)("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:(0,a.jsx)(so.A,{className:"h-6 w-6 text-primary"})})}),(0,a.jsx)(h,{className:"text-2xl text-center",children:"Регистрация"}),(0,a.jsx)(f,{className:"text-center",children:"Создайте новую учетную запись для доступа к системе"})]}),(0,a.jsx)(j,{children:(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),i(!0),t.password!==t.confirmPassword){o({title:"Ошибка",description:"Пароли не совпадают",variant:"destructive"}),i(!1);return}try{d(t.username,t.password,t.email,t.firstName,t.lastName),c(t.username,t.password),o({title:"Регистрация успешна",description:"Вы успешно зарегистрировались и вошли в систему"})}catch(s){let e="Произошла ошибка при регистрации";s instanceof Error&&(e=s.message),o({title:"Ошибка регистрации",description:e,variant:"destructive"})}finally{i(!1)}},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ss,{htmlFor:"firstName",children:"Имя"}),(0,a.jsx)(M,{id:"firstName",name:"firstName",placeholder:"Введите имя",value:t.firstName,onChange:m})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ss,{htmlFor:"lastName",children:"Фамилия"}),(0,a.jsx)(M,{id:"lastName",name:"lastName",placeholder:"Введите фамилию",value:t.lastName,onChange:m})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ss,{htmlFor:"username",children:"Имя пользователя"}),(0,a.jsx)(M,{id:"username",name:"username",placeholder:"Введите имя пользователя",value:t.username,onChange:m,required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ss,{htmlFor:"email",children:"Email"}),(0,a.jsx)(M,{id:"email",name:"email",type:"email",placeholder:"Введите email",value:t.email,onChange:m,required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ss,{htmlFor:"password",children:"Пароль"}),(0,a.jsx)(M,{id:"password",name:"password",type:"password",placeholder:"Введите пароль",value:t.password,onChange:m,required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ss,{htmlFor:"confirmPassword",children:"Подтверждение пароля"}),(0,a.jsx)(M,{id:"confirmPassword",name:"confirmPassword",type:"password",placeholder:"Повторите пароль",value:t.confirmPassword,onChange:m,required:!0})]}),(0,a.jsx)(b,{type:"submit",className:"w-full",disabled:n,children:n?"Регистрация...":"Зарегистрироваться"})]})}),(0,a.jsx)(g,{children:(0,a.jsxs)("div",{className:"text-sm text-center w-full text-muted-foreground",children:["Уже есть аккаунт?"," ",(0,a.jsx)(b,{variant:"link",className:"p-0",onClick:s,children:"Войти"})]})})]})}var su=function(e){return e.LOGIN="login",e.REGISTER="register",e}(su||{});function sp(e){let{isOpen:s,onClose:t}=e,[l,n]=(0,r.useState)("login");return(0,a.jsx)(T,{open:s,onOpenChange:t,children:(0,a.jsx)(z,{className:"sm:max-w-[500px] p-0",hideCloseButton:!0,children:"login"===l?(0,a.jsx)(sc,{onRegisterClick:()=>{n("register")}}):(0,a.jsx)(sm,{onLoginClick:()=>{n("login")}})})})}var sx=t(1354),sh=t(7437);function sf(){let{addRequest:e,getCurrentUser:s,logoutUser:t}=Y(),{toast:l}=el(),[n,i]=(0,r.useState)(!1),[d,p]=(0,r.useState)("structure"),x=s();return(0,a.jsxs)("main",{className:"container px-4 py-6 mx-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"ИИ-конструктор организационной структуры"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Управление отделами, сотрудниками и автоматизированная обработка заявок"})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-sm mr-2",children:["Привет, ",(0,a.jsx)("span",{className:"font-semibold",children:x.firstName||x.username})]}),(0,a.jsxs)(b,{variant:"outline",size:"sm",onClick:()=>{t(),l({title:"Выход из системы",description:"Вы успешно вышли из аккаунта"})},children:[(0,a.jsx)(sx.A,{className:"h-4 w-4 mr-2"}),"Выйти"]})]}):(0,a.jsxs)(b,{variant:"outline",size:"sm",onClick:()=>{i(!0)},children:[(0,a.jsx)(sh.A,{className:"h-4 w-4 mr-2"}),"Войти"]})})]}),(0,a.jsxs)(c,{value:d,onValueChange:p,className:"space-y-4",children:[(0,a.jsxs)(o,{className:"grid grid-cols-5 max-w-2xl",children:[(0,a.jsx)(m,{value:"structure",children:"Структура"}),(0,a.jsx)(m,{value:"requests",children:"Заявки"}),(0,a.jsx)(m,{value:"create-request",children:"Создать заявку"}),(0,a.jsx)(m,{value:"ai-optimization",children:"AI-оптимизация"}),(0,a.jsx)(m,{value:"top-employees",children:"Топ сотрудников"})]}),(0,a.jsx)(u,{value:"structure",className:"space-y-4",children:(0,a.jsx)(eU,{})}),(0,a.jsx)(u,{value:"requests",className:"space-y-4",children:(0,a.jsx)(eX,{})}),(0,a.jsx)(u,{value:"create-request",className:"space-y-4",children:(0,a.jsx)(e0,{onCreate:s=>{try{let t=(null==x?void 0:x.id)||"system-user";e(s.title,s.description,s.type,t),l({title:"Заявка создана",description:"Ваша заявка была успешно создана и отправлена в обработку."})}catch(e){l({title:"Ошибка",description:"Не удалось создать заявку. Пожалуйста, попробуйте еще раз.",variant:"destructive"})}}})}),(0,a.jsx)(u,{value:"ai-optimization",className:"space-y-4",children:(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:(0,a.jsx)(sn,{})})}),(0,a.jsx)(u,{value:"top-employees",className:"space-y-4",children:(0,a.jsx)(si,{})})]}),(0,a.jsx)(sp,{isOpen:n,onClose:()=>{i(!1)}}),(0,a.jsx)(e7,{})]})}},9656:(e,s,t)=>{Promise.resolve().then(t.bind(t,3422))}},e=>{var s=s=>e(e.s=s);e.O(0,[887,441,587,358],()=>s(9656)),_N_E=e.O()}]);